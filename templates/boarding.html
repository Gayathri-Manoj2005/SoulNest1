{% extends "base.html" %}

{% block title %}Adopt a Pet - SoulNest{% endblock %}

{% block head %}
    <!-- Google font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='boarding.css') }}">
{% endblock %}

{% block content %}
<div class="page-wrapper">

    <div class="page-title">
        <h1>Boardings Available For You</h1>
        <p>Filter by pet type and location to find the right boarding near you.</p>
    </div>

    <div class="layout">

        <!-- LEFT FILTER PANEL: submit to /boarding (GET) -->
        <aside class="filter-panel">
            <div class="filter-header">
                <span>Filters</span>
                <a class="clear-filters" href="{{ url_for('shelters') }}">Clear all filters</a>
            </div>

            <form method="get" action="{{ url_for('shelters') }}">
                <div class="filter-group">
                    <label for="petType">Pet type</label>
                    <select id="petType" name="type" class="filter-select">
                        {% for opt in pet_type_options %}
                            {% if opt == "" %}
                                <option value="" {{ 'selected' if selected_pet_type == '' else '' }}>Any</option>
                            {% else %}
                                <option value="{{ opt }}" {{ 'selected' if selected_pet_type == opt else '' }}>{{ opt|capitalize }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>

                <div class="filter-group">
                    <label for="stateSelect">Search by State</label>
                    <select id="stateSelect" name="state" class="filter-select">
                        {% for s in state_options %}
                            {% if s == "" %}
                                <option value="" {{ 'selected' if selected_state == '' else '' }}>Select state...</option>
                            {% else %}
                                <option value="{{ s }}" {{ 'selected' if selected_state == s else '' }}>{{ s }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>

                <div class="filter-group">
                    <label for="citySelect">Search by City</label>
                    <select id="citySelect" name="city" class="filter-select">
                        {% for c in city_options %}
                            {% if c == "" %}
                                <option value="" {{ 'selected' if selected_city == '' else '' }}>Select city...</option>
                            {% else %}
                                <option value="{{ c }}" {{ 'selected' if selected_city == c else '' }}>{{ c }}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                </div>

                <button type="submit" class="filter-btn">Apply Filter</button>
            </form>
        </aside>

        <!-- RIGHT RESULTS AREA -->
        <main class="results">
            <div class="results-title">
                {% if shelters %}
                  Showing {{ shelters|length }} {{ 'result' if shelters|length == 1 else 'results' }}
                {% else %}
                  No boardings found
                {% endif %}
            </div>

            <div class="shelters-grid" id="sheltersGrid">
                {% if shelters %}
                  {% for b in shelters %}
                    <article class="shelter-card">
                        <div class="posted-tag">Posted on: {{ b.posted_on if b.posted_on else '' }}</div>

                        {% if b.image_url %}
                          {% if b.image_url[:4] == 'http' %}
                            <img src="{{ b.image_url }}" alt="{{ b.name }}">
                          {% else %}
                            <img src="{{ url_for('static', filename=b.image_url) }}" alt="{{ b.name }}">
                          {% endif %}
                        {% else %}
                          <img src="{{ url_for('static', filename='images/default_boarding.png') }}" alt="{{ b.name }}">
                        {% endif %}

                        <div class="shelter-name">{{ b.name }}</div>
                        <div class="shelter-meta">
                            {{ b.pet_type|capitalize }}{% if b.city %} Â· {{ b.city }}{% endif %}{% if b.state %}, {{ b.state }}{% endif %}
                        </div>

                        <div class="section-divider"></div>
                        <div class="contact-label">Contact details -</div>
                        <div class="contact-row">
                            <div class="contact-avatar">ðŸ‘¤</div>
                            <div>Number: {{ b.contact_number or 'â€”' }}</div>
                            <div>
                                {% if b.contact_number %}
                                  <a href="tel:{{ b.contact_number }}" class="contact-btn">Contact Now</a>
                                {% else %}
                                  â€”
                                {% endif %}
                            </div>
                        </div>
                    </article>
                  {% endfor %}
                {% else %}
                  <p class="no-results">No boardings match your filters right now. Try clearing filters or choose another city/state.</p>
                {% endif %}
            </div>
        </main>

    </div>
    
</div>



{% endblock %}
